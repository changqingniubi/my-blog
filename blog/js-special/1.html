<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JavaScript专题（一）变量与函数提升 | 九殇的前端进阶笔记</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/my-blog/logo.png">
    <meta name="description" content="在这里一定有能帮助你成长的文章">
    
    <link rel="preload" href="/my-blog/assets/css/0.styles.e03cf7d9.css" as="style"><link rel="preload" href="/my-blog/assets/js/app.16942750.js" as="script"><link rel="preload" href="/my-blog/assets/js/2.a4a101bc.js" as="script"><link rel="preload" href="/my-blog/assets/js/31.e298513c.js" as="script"><link rel="prefetch" href="/my-blog/assets/js/10.67221003.js"><link rel="prefetch" href="/my-blog/assets/js/11.17504448.js"><link rel="prefetch" href="/my-blog/assets/js/12.c440c1b7.js"><link rel="prefetch" href="/my-blog/assets/js/13.36a9759c.js"><link rel="prefetch" href="/my-blog/assets/js/14.52901fe7.js"><link rel="prefetch" href="/my-blog/assets/js/15.02da56a6.js"><link rel="prefetch" href="/my-blog/assets/js/16.11861541.js"><link rel="prefetch" href="/my-blog/assets/js/17.6701e7f6.js"><link rel="prefetch" href="/my-blog/assets/js/18.8fff8d63.js"><link rel="prefetch" href="/my-blog/assets/js/19.569c5beb.js"><link rel="prefetch" href="/my-blog/assets/js/20.9ac19174.js"><link rel="prefetch" href="/my-blog/assets/js/21.ba1d1748.js"><link rel="prefetch" href="/my-blog/assets/js/22.df3e08ba.js"><link rel="prefetch" href="/my-blog/assets/js/23.64974c3d.js"><link rel="prefetch" href="/my-blog/assets/js/24.d8498150.js"><link rel="prefetch" href="/my-blog/assets/js/25.95a7e6b0.js"><link rel="prefetch" href="/my-blog/assets/js/26.e384fcb0.js"><link rel="prefetch" href="/my-blog/assets/js/27.7988aae4.js"><link rel="prefetch" href="/my-blog/assets/js/28.1c24c4bc.js"><link rel="prefetch" href="/my-blog/assets/js/29.f3478c42.js"><link rel="prefetch" href="/my-blog/assets/js/3.f5277c67.js"><link rel="prefetch" href="/my-blog/assets/js/30.16a69881.js"><link rel="prefetch" href="/my-blog/assets/js/32.b38a6437.js"><link rel="prefetch" href="/my-blog/assets/js/33.efb4ba77.js"><link rel="prefetch" href="/my-blog/assets/js/34.0aa3460e.js"><link rel="prefetch" href="/my-blog/assets/js/35.de6c184c.js"><link rel="prefetch" href="/my-blog/assets/js/36.750b0ed3.js"><link rel="prefetch" href="/my-blog/assets/js/37.ccebf9fd.js"><link rel="prefetch" href="/my-blog/assets/js/38.693b1fab.js"><link rel="prefetch" href="/my-blog/assets/js/39.14040020.js"><link rel="prefetch" href="/my-blog/assets/js/4.7ff454be.js"><link rel="prefetch" href="/my-blog/assets/js/5.87cd791f.js"><link rel="prefetch" href="/my-blog/assets/js/6.36f77360.js"><link rel="prefetch" href="/my-blog/assets/js/7.bf4bdbbf.js"><link rel="prefetch" href="/my-blog/assets/js/8.38d9362c.js"><link rel="prefetch" href="/my-blog/assets/js/9.ec1d7803.js">
    <link rel="stylesheet" href="/my-blog/assets/css/0.styles.e03cf7d9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/my-blog/" class="home-link router-link-active"><!----> <span class="site-name">九殇的前端进阶笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/my-blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/my-blog/blog/" class="nav-link router-link-active">
  前端|博文
</a></div><div class="nav-item"><a href="/my-blog/algorithm/" class="nav-link">
  算法|题解
</a></div><div class="nav-item"><a href="/my-blog/css/" class="nav-link">
  CSS|基础
</a></div><div class="nav-item"><a href="https://github.com/changqingniubi/my-blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/my-blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/my-blog/blog/" class="nav-link router-link-active">
  前端|博文
</a></div><div class="nav-item"><a href="/my-blog/algorithm/" class="nav-link">
  算法|题解
</a></div><div class="nav-item"><a href="/my-blog/css/" class="nav-link">
  CSS|基础
</a></div><div class="nav-item"><a href="https://github.com/changqingniubi/my-blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>JavaScript专题</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/my-blog/blog/js-special/1.html" aria-current="page" class="active sidebar-link">JavaScript专题（一）变量与函数提升</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-blog/blog/js-special/1.html#前言" class="sidebar-link">前言</a></li><li class="sidebar-sub-header"><a href="/my-blog/blog/js-special/1.html#一、有趣的现象" class="sidebar-link">一、有趣的现象</a></li><li class="sidebar-sub-header"><a href="/my-blog/blog/js-special/1.html#二、js的预解析" class="sidebar-link">二、Js的预解析</a></li><li class="sidebar-sub-header"><a href="/my-blog/blog/js-special/1.html#三、提升之间的优先级" class="sidebar-link">三、提升之间的优先级</a></li><li class="sidebar-sub-header"><a href="/my-blog/blog/js-special/1.html#四、es6和小结" class="sidebar-link">四、ES6和小结</a></li><li class="sidebar-sub-header"><a href="/my-blog/blog/js-special/1.html#参考" class="sidebar-link">参考</a></li></ul></li><li><a href="/my-blog/blog/js-special/2.html" class="sidebar-link">JavaScript专题（二）数组去重</a></li><li><a href="/my-blog/blog/js-special/3.html" class="sidebar-link">JavaScript专题（三）防抖</a></li><li><a href="/my-blog/blog/js-special/4.html" class="sidebar-link">JavaScript专题（四）节流</a></li><li><a href="/my-blog/blog/js-special/5.html" class="sidebar-link">JavaScript专题（五）深浅拷贝</a></li><li><a href="/my-blog/blog/js-special/6.html" class="sidebar-link">JavaScript专题（六）数据类型检测的那些事</a></li><li><a href="/my-blog/blog/js-special/7.html" class="sidebar-link">JavaScript专题（七）让人头疼的类型转换</a></li><li><a href="/my-blog/blog/js-special/8.html" class="sidebar-link">JavaScript专题（八）数组扁平化</a></li><li><a href="/my-blog/blog/js-special/9.html" class="sidebar-link">JavaScript专题（九）数组中查找指定元素</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript设计模式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ES6</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="javascript专题-一-变量与函数提升"><a href="#javascript专题-一-变量与函数提升" class="header-anchor">#</a> JavaScript专题（一）变量与函数提升</h1> <blockquote><p>相信阅读完前端进阶系列的朋友们已经对Js中经典的知识点有所了解。本系列的第一篇选择了一个值得讨论的问题——变量提升，我们会从遇到问题、分析问题、解决问题、例题测试的方式加深大家对变量提升的认知，一起加油！</p></blockquote> <h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <p>本篇文章是《JavaScript专项进阶系列》的第一篇文章，全系列大概会包含例如：</p> <ul><li>防抖节流</li> <li>扁平化</li> <li>深浅拷贝</li> <li>数组去重</li> <li>排序</li> <li>...</li></ul> <p>等等经典的专项知识点。取名为<strong>专项进阶</strong>是因为它们在很多场合的“出镜率高”很高，为了避免化身<code>google内容搜索师</code>，《JavaScript专项进阶系列》诞生了！！！</p> <p><img src="https://img-blog.csdnimg.cn/20200715170621440.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2piajY1Njg4Mzl6,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p> <h2 id="一、有趣的现象"><a href="#一、有趣的现象" class="header-anchor">#</a> 一、有趣的现象</h2> <p>按照大家的常识，JavaScript代码在执行是一定是自上而下的，你需要输出一个字符串，当然需要提前声明一个<code>保存string类型的变量</code>。如果深奥的道理我都能懂，于是我阅读了下面的代码。</p> <h4 id="_1-1-我以为的开局"><a href="#_1-1-我以为的开局" class="header-anchor">#</a> 1.1 我以为的开局</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">'123'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 123</span>
</code></pre></div><p>我们调换一下代码的位置在再看：</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
<span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">'123'</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>我好像找到规律了!!!</strong></p> <p>当我看完了前两段代码并且进行了“深度思考”后，我好像找到规律了，那就是：在当前代码块后函数中，在变量声明和初始化<code>之前</code>使用变量，会拿不到正确的值。</p> <p align="center"><img width="60%" src="https://img-blog.csdnimg.cn/20200716110537792.jpg"></p> <h4 id="_1-2-实际上是这样的"><a href="#_1-2-实际上是这样的" class="header-anchor">#</a> 1.2 实际上是这样的</h4> <p>带着上面的“结论”我来到了这里</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> val <span class="token operator">=</span> <span class="token string">'九殇'</span><span class="token punctuation">;</span>

<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 九殇</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>果然如此！，在<strong>变量声明和初始化之后</strong>耶稣也阻挡不了我拿到val的值，我说的！！！</p> <p>当我看到下面一段代码时，我已经产生了动摇，此事必要蹊跷。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> val <span class="token operator">=</span> <span class="token string">'九殇'</span><span class="token punctuation">;</span>

<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
    <span class="token keyword">var</span> val <span class="token operator">=</span> <span class="token string">'测试'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Ps：如果大家立即执行函数存在疑问，不妨看看<a href="https://blog.csdn.net/jbj6568839z/article/details/106824296" target="_blank" rel="noopener noreferrer">《JavaScript之深入理解立即调用函数表达式（IIFE）》<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>吧～</p> <p>这...我怂了，是什么原因导致这样的现象发生的呢？Js又是如果处理的呢？</p> <p align="center"><img width="60%" src="https://img-blog.csdnimg.cn/20200716111555639.jpg"></p> <h2 id="二、js的预解析"><a href="#二、js的预解析" class="header-anchor">#</a> 二、Js的预解析</h2> <p>在当前的作用域内，无论在哪里变量声明，在幕后，都会进行一次看不见的移动。</p> <p>注意：<strong>仅声明被“移动”</strong>。即声明和赋值在某些时候被动分开了。而这次看不见的移动实际上就是<code>Js在编译阶段的解析</code>。</p> <p>来看一段《你知不知道的Js》中经典的例子：</p> <div class="language-js extra-class"><pre class="language-js"><code>name <span class="token operator">=</span> <span class="token string">'九殇'</span><span class="token punctuation">;</span> <span class="token comment">// 未添加关键字（未声明），name为全局变量，，即window.name = '九殇'</span>
<span class="token keyword">var</span> name<span class="token punctuation">;</span> <span class="token comment">// 再次声明name，此时name未进行初始化，它的值是undefined吗？</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ？</span>
</code></pre></div><p>结果是成功打印“九殇”，这样<strong>看不见的移动</strong>就发生在Js预解析（编译）之中。</p> <h4 id="_2-1-核心-预解析"><a href="#_2-1-核心-预解析" class="header-anchor">#</a> 2.1 核心：预解析</h4> <p>为了搞明白这个核心问题，我们需要回顾一下，引擎会在解释JavaScript代码之前首先对其进行编译。编译阶段中的一部分工作就是找到所有的声明，并用合适的作用域将它们关联起来。感兴趣的小伙伴可以阅读<a href="https://blog.csdn.net/jbj6568839z/article/details/106793254" target="_blank" rel="noopener noreferrer">《JavaScript中的变量对象》<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>和<a href="https://blog.csdn.net/jbj6568839z/article/details/106618708" target="_blank" rel="noopener noreferrer">《从作用域到作用域链》<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>这两篇文章哦～</p> <p>因此，发生这样的事情，包括<code>变量</code>和<code>函数</code>在内的所有声明都会在任何代码被执行前首先被处理。当你看到<code>var a = 2</code>；时，可能会认为这是一个声明。但JavaScript实际上会将其看成两个声明：var a；和a = 2;。</p> <ul><li>第一个定义声明是在编译阶段进行的。</li> <li>第二个赋值声明会被留在原地等待执行阶段。</li></ul> <p>即代码是这样写的：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 我们看到的代码：</span>
<span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'九殇'</span><span class="token punctuation">;</span>
</code></pre></div><p>但Js会将它解析成：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 声明(Declaration)</span>
<span class="token keyword">var</span> name<span class="token punctuation">;</span> <span class="token comment">// 声明但未初始化，所以分配 undefined</span>

<span class="token comment">// 初始化(Initialization)</span>
name <span class="token operator">=</span> <span class="token string">'九殇'</span><span class="token punctuation">;</span> <span class="token comment">// 初始化（赋值）</span>
</code></pre></div><p>所以本小结的一段代码应该这样分析：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> name<span class="token punctuation">;</span> <span class="token comment">// 声明name提到作用域顶部，并被分配了一个undefined</span>
name <span class="token operator">=</span> <span class="token string">'九殇'</span><span class="token punctuation">;</span> <span class="token comment">// 进行初始化操作</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// '九殇'</span>
</code></pre></div><h4 id="_2-2-注意-只有声明被提升了"><a href="#_2-2-注意-只有声明被提升了" class="header-anchor">#</a> 2.2 注意：只有声明被提升了</h4> <p><strong>只有声明会被提升，而赋值和其他代码逻辑会在执行到代码的位置时才会生效</strong>。所以会有下面的问题：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
    <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'九殇'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>函数被提升了，自然可以正常执行，但变量仅仅是声明被提升了。</p> <h4 id="_2-3-每个作用域都会进行提升操作"><a href="#_2-3-每个作用域都会进行提升操作" class="header-anchor">#</a> 2.3 每个作用域都会进行提升操作</h4> <p>还是上面的代码：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
    <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'九殇'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>实际它在编译时是这样的：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> name<span class="token punctuation">;</span> <span class="token comment">// 声明</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
    name <span class="token operator">=</span> <span class="token string">'九殇'</span><span class="token punctuation">;</span> <span class="token comment">// 初始化</span>
<span class="token punctuation">}</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 函数执行</span>
</code></pre></div><p align="center"><img width="60%" src="https://img-blog.csdnimg.cn/20200716134005198.jpg"></p> <h2 id="三、提升之间的优先级"><a href="#三、提升之间的优先级" class="header-anchor">#</a> 三、提升之间的优先级</h2> <p>既然我们知道了<code>变量</code>和<code>函数</code>会被提升，他们之间又是如何判断优先级的呢？</p> <h5 id="_3-1-函数会被首先提升-然后才是变量"><a href="#_3-1-函数会被首先提升-然后才是变量" class="header-anchor">#</a> 3.1 函数会被首先提升，然后才是变量</h5> <p>我们分析下面的代码：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> foo<span class="token punctuation">;</span> <span class="token comment">// 1</span>

<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'九殇'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'小李'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>本着函数优先提升的原则，他会被解析成这样：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'九殇'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 九殇</span>

<span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'小李'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>注意，<code>var foo</code> 因为是一个重复声明，且优先级<code>低于函数声明</code>所以它被忽略掉了。</p> <h4 id="_3-2-函数字面量不会进行函数提升"><a href="#_3-2-函数字面量不会进行函数提升" class="header-anchor">#</a> 3.2 函数字面量不会进行函数提升</h4> <p>最直观的例子，就是在函数字面量前调用该函数：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// TypeError: foo is not a function</span>
</code></pre></div><p>这段程序中：</p> <ol><li>变量标识符<code>foo()</code>被提升并分配给所在作用域（在这里是全局作用域），因此foo()<strong>不会导致ReferenceError</strong>。</li> <li>然后就是执行foo，foo此时并没有赋值（注意变量被提升了）。由于对undefined值进行函数调用而导致非法操作，因此抛出TypeError异常。</li></ol> <h2 id="四、es6和小结"><a href="#四、es6和小结" class="header-anchor">#</a> 四、ES6和小结</h2> <p>ES6新增了两个命令<code>let</code>和<code>const</code>，用来声明变量，有关它们完整的概念我会在《ES6基础系列》中总结，提起它们，是因为<strong>变量提升在它们身上不会存在</strong>。</p> <h5 id="_4-1-变量提升是可以规避的"><a href="#_4-1-变量提升是可以规避的" class="header-anchor">#</a> 4.1 变量提升是可以规避的</h5> <p>let命令改变了语法行为，它所声明的变量一定要在声明后使用，否则报错。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// var 的情况</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出undefined</span>
<span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

<span class="token comment">// let 的情况</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>bar<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 报错ReferenceError</span>
<span class="token keyword">let</span> bar <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre></div><p>上面代码中，变量foo用var命令声明，会发生变量提升，即脚本开始运行时，变量foo已经存在了，但是没有值，所以会输出undefined。变量bar用let命令声明，不会发生变量提升。这表示在声明它之前，变量bar是不存在的，这时如果用到它，就会抛出一个错误。</p> <p>在变量提升上，const和let一样，只在声明所在的块级作用域内有效，也不会变量提升</p> <h4 id="_4-2-小结"><a href="#_4-2-小结" class="header-anchor">#</a> 4.2 小结</h4> <ol><li>变量提升：函数声明和变量声明总是会被解释器悄悄地被&quot;提升&quot;到方法体的最顶部，但变量的初始化不会提升；</li> <li>函数提升：函数声明可以被看作是函数的整体被提升到了代码的顶部，但函数字面量表达式并不会引发函数提升；</li> <li>函数提升优先与变量提升；</li> <li>let和const可以有效的规避变量提升</li></ol> <p>最后提炼一下《你不知道的JS》中的一段话：<strong>JavaScript引擎并不总是按照代码的顺序来进行解析。在编译阶段，无论作用域中的声明出现在什么地方，都将在代码本身被执行前首先进行处理，这个过程被称为提升。声明本身会被提升，而包括函数表达式的赋值在内的赋值操作并不会提升。</strong></p> <p align="center"><img width="60%" src="https://img-blog.csdnimg.cn/20200716184711721.jpg"></p> <h2 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h2> <ul><li>你不知道的Js（上）</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/my-blog/blog/js-basics/10.html" class="prev">
        JavaScript基础（总结）你真的了解Js吗
      </a></span> <span class="next"><a href="/my-blog/blog/js-special/2.html">
        JavaScript专题（二）数组去重
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/my-blog/assets/js/app.16942750.js" defer></script><script src="/my-blog/assets/js/2.a4a101bc.js" defer></script><script src="/my-blog/assets/js/31.e298513c.js" defer></script>
  </body>
</html>
